<?phpclass OperationComponent extends Component {	public function degreelat($dec) {		$vars = explode(".",$dec);		$deg = '';		$tempma = '';		$min = '';		$sec = '';		$latPos = '';		if(is_array($vars) && count($vars) > 1){			$deg = $vars[0];			$deg = str_replace("-", "", "$deg");			$tempma = "0.".$vars[1];			$tempma = $tempma * 3600;			$min = floor($tempma / 60);			$sec = $tempma - ($min*60);			$sec = round("$sec", 2);						if (strpos($dec, '-') !== false) { 			   $latPos = "South ";			   } else {			   $latPos = "North ";			  }		}			return "$deg&deg;$min&apos;$sec&quot; $latPos";	} 	public function degreelng($dec) { 		$vars = explode(".",$dec);		$deg = '';		$tempma = '';		$min = '';		$sec = '';		$latPos = '';		if(is_array($vars) && count($vars) > 1){			$deg = $vars[0];			$deg = str_replace("-", "", "$deg");			//debug($vars);			$tempma = "0.".$vars[1];		 			$tempma = $tempma * 3600;			$min = floor($tempma / 60);			$sec = $tempma - ($min*60);			$sec = round("$sec", 2);		 		  if (strpos($dec, '-') !== false) { 		   $latPos = "West ";		   } else {		   $latPos = "East ";		  }  		}	return "$deg&deg;$min&apos;$sec&quot; $latPos";	}	public function updateLatLng($params,$class,$id){		$address = '';		$string = '';		//debug($params);		if(is_array($params)){			foreach($params as $pass){				if(!empty($pass)){					$passarray = explode(' ',$pass);					if(count($passarray) > 0){						$tempstring = '';						foreach($passarray as $part){							//debug($a);exit;							$tempstring .= $part.'+';						}						$tempstring = rtrim($tempstring,'+');					}else{						$tempstring = $pass;					}					$string .= $tempstring.',';				}			}			$address = rtrim($string,',');		}else{			$address = $params;		}						$url = "https://maps.google.com/maps/api/geocode/json?address=$address&sensor=false";		$ch = curl_init();		curl_setopt($ch, CURLOPT_URL, $url);		curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);		curl_setopt($ch, CURLOPT_PROXYPORT, 3128);		curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);		curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0);		$response = curl_exec($ch);		curl_close($ch);		$response_a = json_decode($response);		//debug($response_a->status);exit;		if(@$response_a->status == 'ZERO_RESULTS' && count($params) > 0){			$params = array_pop($params);			$this->updateLatLng($params,$class,$id);			return;		}		if(@$response_a->status != 'ZERO_RESULTS'){			$lat = @$response_a->results[0]->geometry->location->lat;			$lng = @$response_a->results[0]->geometry->location->lng;			$address = @$response_a->results[0]->formatted_address;			if(empty($address)){				$area1 =  @$response_a->results[0]->address_components[3]->long_name;				$area2 =  @$response_a->results[0]->address_components[2]->long_name;				$area3 =  @$response_a->results[0]->address_components[1]->long_name;				$address = $area3.', '.$area2.', '.$area1;			}			if(!empty($lat) && !empty($lng)){				$iconPath = 'http://www.infomap24.com/indicator32.png';				$url = "http://maps.googleapis.com/maps/api/staticmap?center=$lat,$lng&zoom=14&size=400x300&markers=icon:$iconPath|$lat,$lng&style=feature:administrative|element:labels.text.fill|color:#ff0000&style=feature:landscape|element:all|color:#f2f2f2&style=feature:poi|element:all|visibility:off&style=feature:road|element:all|saturation:-100|lightness:45&style=feature:road.highway|element:all|visibility:simplified&style=feature:road.arterial|element:labels.icon|visibility:off&style=feature:transit|element:all|visibility:off&style=feature:water|element:all|color:#46bcec|visibility:on&sensor=false";				$imageName = md5(time().rand()).'.png';				$img = WWW_ROOT.'img'.DS.'placemaps'.DS.$imageName ;					if(@file_put_contents($img, @file_get_contents($url))){}							$class = 'Point';			$this->$class = ClassRegistry::init($class);			$this->$class->read(null, $id);			$this->$class->set('address', $address);			$this->$class->set('lat', $lat);			$this->$class->set('lng', $lng);			$this->$class->set('map', $imageName);			$this->$class->save();			}				}					}	public function banglanumber( $str ) {		$engNumber = array(1,2,3,4,5,6,7,8,9,0);		$bangNumber = array('১','২','৩','৪','৫','৬','৭','৮','৯','০');		$converted = str_replace($engNumber, $bangNumber, $str);	 		return $converted;	}		}?>